<template>
    <div class="app-container">
        <el-container class="main-container">
            <!-- È°∂ÈÉ®ÊêúÁ¥¢Âå∫ -->
            <el-header class="header-section">
                <div class="header-content">
                    <div class="search-wrapper">
                        <el-autocomplete
                            ref="searchInput"
                            v-model="searchQuery"
                            :fetch-suggestions="handleSearch"
                            placeholder="üîç ÊêúÁ¥¢‰π¶Á≠æÔºåÊåâÂõûËΩ¶Âø´ÈÄüË∑≥ËΩ¨ (Ctrl+K)"
                            prefix-icon="Search"
                            @select="handleSelect"
                            @keydown="handleKeyDown"
                            @compositionstart="handleCompositionStart"
                            @compositionend="handleCompositionEnd"
                            clearable
                            size="large"
                            class="search-input"
                            :popper-options="{
                                modifiers: [{
                                    name: 'offset',
                                    options: {
                                        offset: [0, 12]
                                    }
                                }]
                            }"
                            :popper-class="'search-suggestions'"
                        >
                            <template #suffix>
                                <el-dropdown trigger="click" @command="handleSearchFilter">
                                    <el-button :icon="Filter" circle size="small" class="filter-btn" />
                                    <template #dropdown>
                                        <el-dropdown-menu class="filter-dropdown">
                                            <el-dropdown-item command="all">üåü ÂÖ®ÈÉ®</el-dropdown-item>
                                            <el-dropdown-item divided command="recent">‚è∞ ÊúÄËøë‰ΩøÁî®</el-dropdown-item>
                                            <el-dropdown-item command="folder">üìÅ ÊåâÊñá‰ª∂Â§πÁ≠õÈÄâ</el-dropdown-item>
                                        </el-dropdown-menu>
                                    </template>
                                </el-dropdown>
                            </template>
                    <template #default="{ item }">
                        <div style="display: flex; align-items: center; padding: 8px 0;">
                            <el-avatar 
                                v-if="!item.isHistory" 
                                :src="item.icon" 
                                size="small" 
                                style="margin-right: 12px; flex-shrink: 0;"
                            />
                            <el-icon v-else style="margin-right: 12px; color: #909399;">
                                <Clock />
                            </el-icon>
                            <div style="flex: 1; min-width: 0;">
                                <div style="font-weight: 500; color: #303133; margin-bottom: 2px;">
                                    {{ item.title || item.value }}
                                </div>
                                <div v-if="item.url && !item.isHistory" style="font-size: 12px; color: #909399; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                                    {{ item.url }}
                                </div>
                                <div v-if="item.isHistory" style="font-size: 12px; color: #909399;">
                                    ÊêúÁ¥¢ÂéÜÂè≤
                                </div>
                            </div>
                        </div>
                    </template>
                        </el-autocomplete>
                    </div>
                </div>
            </el-header>

            <el-container class="content-container">
                <!-- ‰æßËæπÊ†èÊñá‰ª∂Â§πÊ†ë -->
                <el-aside class="sidebar">
                    <div class="sidebar-header">
                        <h3 class="sidebar-title">
                            <el-icon class="sidebar-icon"><Folder /></el-icon>
                            Êñá‰ª∂Â§π
                        </h3>
                    </div>
                    <div class="folder-tree-wrapper">
                        <el-tree
                            v-model="currentFolder"
                            :data="folderTree"
                            :props="folderTreeProps"
                            node-key="id"
                            @node-click="handleFolderClick"
                            class="folder-tree"
                            :highlight-current="true"
                            :expand-on-click-node="false"
                        >
                            <template #default="{ node, data }">
                                <el-dropdown
                                    trigger="contextmenu"
                                    @command="(command) => handleFolderCommand(command, data)"
                                >
                                    <div class="folder-tree-node">
                                        <el-icon class="folder-icon"><Folder /></el-icon>
                                        <span class="folder-name">{{ data.title }}</span>
                                    </div>
                                    <template #dropdown>
                                        <el-dropdown-menu>
                                            <el-dropdown-item command="edit">
                                                <el-icon><Edit /></el-icon>
                                                ÁºñËæëÊñá‰ª∂Â§π
                                            </el-dropdown-item>
                                            <el-dropdown-item command="delete" divided>
                                                <el-icon><Delete /></el-icon>
                                                Âà†Èô§Êñá‰ª∂Â§π
                                            </el-dropdown-item>
                                        </el-dropdown-menu>
                                    </template>
                                </el-dropdown>
                            </template>
                        </el-tree>
                    </div>
                </el-aside>

                <!-- ‰∏ªÂÜÖÂÆπÂå∫ -->
                <el-main class="main-content">
                    <!-- Â∑•ÂÖ∑Ê†è -->
                    <div class="toolbar">
                        <div class="toolbar-section">
                            <el-button type="primary" @click="importBookmarks" class="action-btn import-btn">
                                <el-icon><Download /></el-icon>
                                ÂØºÂÖ•‰π¶Á≠æ
                            </el-button>
                            <el-button type="success" @click="exportBookmarks" class="action-btn export-btn">
                                <el-icon><Upload /></el-icon>
                                ÂØºÂá∫‰π¶Á≠æ
                            </el-button>
                        </div>
                        <div class="toolbar-section">
                            <el-button type="primary" @click="addBookmark" class="action-btn add-btn">
                                <el-icon><Plus /></el-icon>
                                Êñ∞Â¢û
                            </el-button>
                            <el-button type="danger" @click="clearBookmarks" class="action-btn clear-btn">
                                <el-icon><FolderDelete /></el-icon>
                                Ê∏ÖÁ©∫
                            </el-button>
                        </div>
                    </div>

                    <!-- ‰π¶Á≠æÁªüËÆ°‰ø°ÊÅØ -->
                    <div class="stats-bar" v-if="bookmarks.length > 0">
                        <div class="stats-item">
                            <el-icon><Document /></el-icon>
                            <span>ÂÖ± {{ bookmarks.length }} ‰∏™‰π¶Á≠æ</span>
                        </div>
                        <div class="stats-item" v-if="currentFolder">
                            <el-icon><Folder /></el-icon>
                            <span>ÂΩìÂâçÊñá‰ª∂Â§π</span>
                        </div>
                    </div>

                    <!-- ‰π¶Á≠æÂàóË°® -->
                    <div class="bookmarks-container">
                        <div class="bookmarks-grid" v-if="bookmarks.length > 0">
                            <div 
                                v-for="bookmark in bookmarks" 
                                :key="bookmark.id" 
                                class="bookmark-card-wrapper"
                            >
                                <el-card class="bookmark-card" shadow="hover" @click="openBookmark(bookmark)">
                                    <div class="bookmark-body">
                                        <!-- Â∑¶‰æßÂõæÊ†á -->
                                        <div class="bookmark-favicon">
                                            <el-avatar 
                                                :src="bookmark.icon" 
                                                :size="40"
                                                class="favicon"
                                            >
                                                <el-icon><Link /></el-icon>
                                            </el-avatar>
                                        </div>
                                        
                                        <!-- Âè≥‰æßÂÜÖÂÆπÂå∫ -->
                                        <div class="bookmark-info">
                                            <!-- Ê†áÈ¢ò -->
                                            <div class="bookmark-title">
                                                <el-text class="title-text" :title="bookmark.title">
                                                    {{ bookmark.title }}
                                                </el-text>
                                            </div>
                                            
                                            <!-- ÈìæÊé• -->
                                            <div class="bookmark-url-container">
                                                <div class="bookmark-url" :title="bookmark.url">
                                                    <el-text class="url-text">
                                                        {{ bookmark.url }}
                                                    </el-text>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Êìç‰ΩúÊåâÈíÆÁªÑ -->
                                        <div class="bookmark-actions" @click.stop>
                                            <el-button 
                                                type="primary" 
                                                :icon="Edit" 
                                                circle 
                                                size="small"
                                                @click="editBookmark(bookmark)"
                                                class="action-btn-circle edit-action"
                                                title="ÁºñËæë"
                                            />
                                            <el-button
                                                type="danger"
                                                :icon="Delete"
                                                circle
                                                size="small"
                                                @click="onRemoved(bookmark.id, bookmark)"
                                                class="action-btn-circle delete-action"
                                                title="Âà†Èô§"
                                            />
                                        </div>
                                    </div>
                                </el-card>
                            </div>
                        </div>
                        
                        <!-- Á©∫Áä∂ÊÄÅ -->
                        <div v-else class="empty-state">
                            <div class="empty-icon">
                                <el-icon size="64"><DocumentCopy /></el-icon>
                            </div>
                            <h3 class="empty-title">ÊöÇÊó†‰π¶Á≠æ</h3>
                            <p class="empty-description">ÁÇπÂáª„ÄåÊñ∞Â¢û„ÄçÊåâÈíÆÊ∑ªÂä†ÊÇ®ÁöÑÁ¨¨‰∏Ä‰∏™‰π¶Á≠æÂêßÔºÅ</p>
                            <el-button type="primary" @click="addBookmark" class="empty-action">
                                <el-icon><Plus /></el-icon>
                                Ê∑ªÂä†‰π¶Á≠æ
                            </el-button>
                        </div>
                    </div>
                </el-main>
            </el-container>
        </el-container>
    </div>
        
        <!-- Ê∑ªÂä†‰π¶Á≠æ/Êñá‰ª∂Â§πÂØπËØùÊ°Ü -->
        <el-dialog 
            v-model="addBookmarkDialogVisible" 
            :title="bookmarkForm.url ? 'Ê∑ªÂä†‰π¶Á≠æ' : 'Ê∑ªÂä†Êñá‰ª∂Â§π'" 
            width="500px"
            :before-close="cancelAddBookmark"
        >
            <el-form :model="bookmarkForm" label-width="80px">
                <el-form-item label="Ê†áÈ¢ò" required>
                    <el-input 
                        v-model="bookmarkForm.title" 
                        placeholder="ËØ∑ËæìÂÖ•Ê†áÈ¢ò"
                        clearable
                    />
                </el-form-item>
                <el-form-item label="ÈìæÊé•">
                    <el-input 
                        v-model="bookmarkForm.url" 
                        placeholder="ËØ∑ËæìÂÖ•‰π¶Á≠æÈìæÊé•ÔºàÂ¶ÇÔºöhttps://example.comÔºâÔºå‰∏çÂ°´ÂàôÂàõÂª∫Êñá‰ª∂Â§π"
                        clearable
                    />
                </el-form-item>
                <el-form-item label="Êñá‰ª∂Â§π">
                    <el-tree-select
                        v-model="bookmarkForm.parentId"
                        :data="folderTree"
                        :props="folderTreeProps"
                        node-key="id"
                        :render-after-expand="false"
                        :check-strictly="true"
                        placeholder="ÈÄâÊã©Êñá‰ª∂Â§πÔºàÂèØÈÄâÔºâ"
                        clearable
                        style="width: 100%"
                    />
                </el-form-item>
            </el-form>
            
            <template #footer>
                <div class="dialog-footer">
                    <el-button @click="cancelAddBookmark">ÂèñÊ∂à</el-button>
                    <el-button type="primary" @click="confirmAddBookmark">Á°ÆÂÆö</el-button>
                </div>
            </template>
        </el-dialog>

        <!-- ÁºñËæë‰π¶Á≠æ/Êñá‰ª∂Â§πÂØπËØùÊ°Ü -->
        <el-dialog 
            v-model="editBookmarkDialogVisible" 
            :title="editForm.url ? 'ÁºñËæë‰π¶Á≠æ' : 'ÁºñËæëÊñá‰ª∂Â§π'" 
            width="500px"
            :before-close="cancelEdit"
        >
            <el-form :model="editForm" label-width="80px">
                <el-form-item label="Ê†áÈ¢ò" required>
                    <el-input 
                        v-model="editForm.title" 
                        placeholder="ËØ∑ËæìÂÖ•Ê†áÈ¢ò"
                        clearable
                    />
                </el-form-item>
                <el-form-item label="ÈìæÊé•" v-if="editForm.url !== undefined">
                    <el-input 
                        v-model="editForm.url" 
                        placeholder="ËØ∑ËæìÂÖ•‰π¶Á≠æÈìæÊé•ÔºàÂ¶ÇÔºöhttps://example.comÔºâ"
                        clearable
                    />
                </el-form-item>
                <el-form-item label="Êñá‰ª∂Â§π">
                    <el-tree-select
                        v-model="editForm.parentId"
                        :data="folderTree"
                        :props="folderTreeProps"
                        node-key="id"
                        :render-after-expand="false"
                        :check-strictly="true"
                        placeholder="ÈÄâÊã©Êñá‰ª∂Â§πÔºàÂèØÈÄâÔºâ"
                        clearable
                        style="width: 100%"
                    />
                </el-form-item>
            </el-form>
            
            <template #footer>
                <div class="dialog-footer">
                    <el-button @click="cancelEdit">ÂèñÊ∂à</el-button>
                    <el-button type="primary" @click="confirmEdit">Á°ÆÂÆö</el-button>
                </div>
            </template>
        </el-dialog>
</template>

<script lang="ts" setup>
import { ref, onMounted, onUnmounted } from 'vue';
import { Link, Search, Download, Upload, Plus, Delete, Edit, Clock, Filter, Folder, Document, DocumentCopy, FolderDelete } from '@element-plus/icons-vue';
import { MyBookmarks } from './utils/bookmarks';
import { ElMessage, ElMessageBox } from 'element-plus';
import { parseHtmlToBookmarks, bookmarksToHtml } from './utils/parser';
import type { BookmarkTreeNode, CreateDetails } from './types/bookmark';

// ÊêúÁ¥¢Áõ∏ÂÖ≥
const searchQuery = ref('');
const allBookmarks = ref<BookmarkTreeNode[]>([]);
const searchHistory = ref<string[]>([]);
const maxSearchHistory = 10;
const searchInput = ref();
const searchFilter = ref('all'); // 'all', 'recent', 'folder'
const searchFolderId = ref('');

// ‰∏≠ÊñáËæìÂÖ•Ê≥ïÁä∂ÊÄÅ
const isComposing = ref(false);

// ÊêúÁ¥¢Á≠õÈÄâÂô®Â§ÑÁêÜ
function handleSearchFilter(command: string) {
    searchFilter.value = command;
    if (command === 'folder') {
        // ÂèØ‰ª•Âú®ËøôÈáåÊ∑ªÂä†Êñá‰ª∂Â§πÈÄâÊã©ÈÄªËæë
        searchFolderId.value = currentFolder.value;
    } else {
        searchFolderId.value = '';
    }
    // ÈáçÊñ∞ÊêúÁ¥¢
    if (searchQuery.value.trim()) {
        handleSearch(searchQuery.value, () => {});
    }
}

// Âø´Êç∑ÈîÆÂ§ÑÁêÜ
function handleKeyDown(event: KeyboardEvent) {
    // ESC Ê∏ÖÁ©∫ÊêúÁ¥¢Ê°Ü
    if (event.key === 'Escape') {
        searchQuery.value = '';
        searchInput.value?.blur();
        return;
    }
    
    // Â§ÑÁêÜÂõûËΩ¶ÈîÆÔºå‰ΩÜË¶ÅËÄÉËôë‰∏≠ÊñáËæìÂÖ•Ê≥ïÁä∂ÊÄÅ
    if (event.key === 'Enter') {
        // Â¶ÇÊûúÊ≠£Âú®‰ΩøÁî®‰∏≠ÊñáËæìÂÖ•Ê≥ïÔºå‰∏çËß¶ÂèëË∑≥ËΩ¨
        if (!isComposing.value) {
            handleSearchJump();
        }
    }
}

// ‰∏≠ÊñáËæìÂÖ•Ê≥ïÂºÄÂßã
function handleCompositionStart() {
    isComposing.value = true;
}

// ‰∏≠ÊñáËæìÂÖ•Ê≥ïÁªìÊùü
function handleCompositionEnd() {
    isComposing.value = false;
}

// ÂÖ®Â±ÄÂø´Êç∑ÈîÆ
function handleGlobalKeyDown(event: KeyboardEvent) {
    // Ctrl+K Êàñ Cmd+K ËÅöÁÑ¶ÊêúÁ¥¢Ê°Ü
    if ((event.ctrlKey || event.metaKey) && event.key === 'k') {
        event.preventDefault();
        searchInput.value?.focus();
    }
    // / ËÅöÁÑ¶ÊêúÁ¥¢Ê°ÜÔºà‰ªÖÂΩì‰∏çÂú®ËæìÂÖ•Ê°ÜÂÜÖÊó∂Ôºâ
    else if (event.key === '/' && !isInInputElement(event.target as Element)) {
        event.preventDefault();
        searchInput.value?.focus();
    }
}

// Ê£ÄÊü•ÊòØÂê¶Âú®ËæìÂÖ•ÂÖÉÁ¥†ÂÜÖ
function isInInputElement(element: Element): boolean {
    const inputElements = ['INPUT', 'TEXTAREA', 'SELECT'];
    return inputElements.includes(element.tagName) || element.hasAttribute('contenteditable');
}

// Âä†ËΩΩÂÖ®ÈÉ®‰π¶Á≠æÔºàÁî®‰∫éÊêúÁ¥¢Ôºâ
async function loadAllBookmarks() {
    allBookmarks.value = await bookmarkDB.search('');
}

// Â§ÑÁêÜÊêúÁ¥¢Âª∫ËÆÆ
function handleSearch(query: string, callback: (data: any[]) => void) {
    if (query.trim()) {
        const queryLower = query.toLowerCase();
        let filteredBookmarks = allBookmarks.value;
        
        // ÊåâÁ≠õÈÄâÂô®ËøáÊª§
        switch (searchFilter.value) {
            case 'recent':
                filteredBookmarks = allBookmarks.value
                    .filter(bookmark => bookmark.dateLastUsed && bookmark.dateLastUsed > 0)
                    .sort((a, b) => (b.dateLastUsed || 0) - (a.dateLastUsed || 0))
                    .slice(0, 20);
                break;
            case 'folder':
                if (searchFolderId.value) {
                    filteredBookmarks = allBookmarks.value
                        .filter(bookmark => bookmark.parentId === searchFolderId.value);
                }
                break;
            default:
                filteredBookmarks = allBookmarks.value;
        }
        
        const results = filteredBookmarks
            .filter((bookmark) => 
                bookmark.title.toLowerCase().includes(queryLower) || 
                (bookmark.url && bookmark.url.toLowerCase().includes(queryLower))
            )
            .map((bookmark) => {
                // ËÆ°ÁÆóÂåπÈÖçÂ∫¶ÂàÜÊï∞
                let score = 0;
                const titleMatch = bookmark.title.toLowerCase().indexOf(queryLower);
                const urlMatch = bookmark.url ? bookmark.url.toLowerCase().indexOf(queryLower) : -1;
                
                // Ê†áÈ¢òÂåπÈÖçÂàÜÊï∞Êõ¥È´ò
                if (titleMatch === 0) score += 100; // ÂºÄÂ§¥ÂåπÈÖç
                else if (titleMatch > -1) score += 50; // ÈÉ®ÂàÜÂåπÈÖç
                
                if (urlMatch === 0) score += 30;
                else if (urlMatch > -1) score += 10;
                
                // ÊúÄËøë‰ΩøÁî®Âä†ÂàÜ
                if (bookmark.dateLastUsed && bookmark.dateLastUsed > 0) {
                    const daysSinceUse = (Date.now() / 1000 - bookmark.dateLastUsed) / (24 * 60 * 60);
                    score += Math.max(0, 20 - daysSinceUse);
                }
                
                return {
                    value: bookmark.title,
                    url: bookmark.url,
                    id: bookmark.id,
                    icon: bookmark.icon,
                    title: bookmark.title,
                    parentId: bookmark.parentId,
                    score
                };
            })
            .sort((a, b) => b.score - a.score) // ÊåâÂàÜÊï∞ÊéíÂ∫è
            .slice(0, 10); // ÈôêÂà∂Âª∫ËÆÆÊï∞Èáè
        
        // Â¶ÇÊûúÊ≤°ÊúâÂåπÈÖçÁªìÊûúÔºåÊòæÁ§∫ÊêúÁ¥¢ÂéÜÂè≤
        if (results.length === 0 && searchHistory.value.length > 0) {
            const historyResults = searchHistory.value
                .filter(item => item.toLowerCase().includes(queryLower))
                .slice(0, 5)
                .map(item => ({
                    value: item,
                    isHistory: true
                }));
            callback(historyResults);
        } else {
            callback(results);
        }
    } else {
        // ÊòæÁ§∫ÊúÄËøëÊêúÁ¥¢ÂéÜÂè≤
        const historyResults = searchHistory.value
            .slice(0, 5)
            .map(item => ({
                value: item,
                isHistory: true
            }));
        callback(historyResults);
    }
}

// Â§ÑÁêÜÈÄâ‰∏≠Âª∫ËÆÆÈ°π
function handleSelect(item: any) {
    if (item.isHistory) {
        // ÈÄâ‰∏≠ÂéÜÂè≤ÊêúÁ¥¢È°πÔºåËß¶ÂèëÊêúÁ¥¢
        searchQuery.value = item.value;
        handleSearchJump();
    } else if (item.url) {
        // Ê∑ªÂä†Âà∞ÊêúÁ¥¢ÂéÜÂè≤
        addToSearchHistory(searchQuery.value);
        window.open(item.url, '_blank');
        // Êõ¥Êñ∞‰ΩøÁî®Êó∂Èó¥
        updateBookmarkUsage(item.id);
    }
}

// Ê∑ªÂä†Âà∞ÊêúÁ¥¢ÂéÜÂè≤
function addToSearchHistory(query: string) {
    if (!query.trim()) return;
    
    const trimmedQuery = query.trim();
    // ÁßªÈô§Â∑≤Â≠òÂú®ÁöÑÈ°πÁõÆ
    const index = searchHistory.value.indexOf(trimmedQuery);
    if (index > -1) {
        searchHistory.value.splice(index, 1);
    }
    
    // Ê∑ªÂä†Âà∞ÂºÄÂ§¥
    searchHistory.value.unshift(trimmedQuery);
    
    // ‰øùÊåÅÂéÜÂè≤ËÆ∞ÂΩïÊï∞ÈáèÈôêÂà∂
    if (searchHistory.value.length > maxSearchHistory) {
        searchHistory.value = searchHistory.value.slice(0, maxSearchHistory);
    }
    
    // ‰øùÂ≠òÂà∞Êú¨Âú∞Â≠òÂÇ®
    localStorage.setItem('searchHistory', JSON.stringify(searchHistory.value));
}

// Êõ¥Êñ∞‰π¶Á≠æ‰ΩøÁî®ËÆ∞ÂΩï
async function updateBookmarkUsage(id: string) {
    try {
        await bookmarkDB.update(id, { 
            dateLastUsed: Date.now() / 1000 
        });
    } catch (error) {
        console.warn('Failed to update bookmark usage:', error);
    }
}

// Âä†ËΩΩÊêúÁ¥¢ÂéÜÂè≤
function loadSearchHistory() {
    try {
        const saved = localStorage.getItem('searchHistory');
        if (saved) {
            searchHistory.value = JSON.parse(saved);
        }
    } catch (error) {
        console.warn('Failed to load search history:', error);
        searchHistory.value = [];
    }
}

// Êñá‰ª∂Â§πÁõ∏ÂÖ≥
const folderTree = ref<any[]>([]);
const currentFolder = ref('');
const folderTreeProps = ref({
    value: 'id',
    label: 'title',
    children: 'children'
});

// ‰π¶Á≠æÂàóË°®Áõ∏ÂÖ≥
const bookmarks = ref<BookmarkTreeNode[]>([]);

// ‰π¶Á≠æÊï∞ÊçÆÂ∫ìÂÆû‰æã
const bookmarkDB = new MyBookmarks();

// Ê∑ªÂä†‰π¶Á≠æÂØπËØùÊ°ÜÁõ∏ÂÖ≥
const addBookmarkDialogVisible = ref(false);
const bookmarkForm = ref({
    title: '',
    url: '',
    parentId: ''
});

// ÁºñËæë‰π¶Á≠æÂØπËØùÊ°ÜÁõ∏ÂÖ≥
const editBookmarkDialogVisible = ref(false);
const editForm = ref({
    id: '',
    title: '',
    url: '',
    parentId: ''
});
const editingBookmark = ref<BookmarkTreeNode | null>(null);

// ÂàùÂßãÂåñ
onMounted(async () => {
    await loadFolderTree();
    await loadBookmarks();
    await loadAllBookmarks();
    loadSearchHistory();
    
    // Ê∑ªÂä†ÂÖ®Â±ÄÂø´Êç∑ÈîÆÁõëÂê¨
    document.addEventListener('keydown', handleGlobalKeyDown);
});

// Ê∏ÖÁêÜ
onUnmounted(() => {
    document.removeEventListener('keydown', handleGlobalKeyDown);
});

// Âä†ËΩΩÊñá‰ª∂Â§πÊ†ë
async function loadFolderTree() {
    // ‰ªéÊï∞ÊçÆÂ∫ìÂä†ËΩΩÊñá‰ª∂Â§πÊ†ë
    folderTree.value = await bookmarkDB.getFolderTree();
}

// Âä†ËΩΩ‰π¶Á≠æ
async function loadBookmarks() {
    // ÂÆûÈôÖÂ∫îÁî®‰∏≠ÔºåËøôÈáåÂ∫îËØ•Ê†πÊçÆÂΩìÂâçÈÄâ‰∏≠ÁöÑÊñá‰ª∂Â§πÂä†ËΩΩ‰π¶Á≠æ
    bookmarks.value = await bookmarkDB.getBookmarkChildren(currentFolder.value);
}

// ÊâìÂºÄ‰π¶Á≠æ
function openBookmark(bookmark: BookmarkTreeNode) {
    if (bookmark.url) {
        window.open(bookmark.url, '_blank');
        // Êõ¥Êñ∞‰ΩøÁî®ËÆ∞ÂΩï
        updateBookmarkUsage(bookmark.id);
    }
}

// ÊêúÁ¥¢Ë∑≥ËΩ¨
function handleSearchJump() {
    const query = searchQuery.value.trim();
    if (query) {
        // Ê∑ªÂä†Âà∞ÊêúÁ¥¢ÂéÜÂè≤
        addToSearchHistory(query);
        
        // ÊâæÂà∞Á¨¨‰∏Ä‰∏™ÂåπÈÖçÁöÑ‰π¶Á≠æÂπ∂Ë∑≥ËΩ¨
        const queryLower = query.toLowerCase();
        const matched = allBookmarks.value.find((bookmark) =>
            bookmark.title.toLowerCase().includes(queryLower) || 
            (bookmark.url && bookmark.url.toLowerCase().includes(queryLower))
        );
        
        if (matched && matched.url) {
            window.open(matched.url, '_blank');
            // Êõ¥Êñ∞‰ΩøÁî®ËÆ∞ÂΩï
            updateBookmarkUsage(matched.id);
        } else {
            ElMessage.info('Êú™ÊâæÂà∞ÂåπÈÖçÁöÑ‰π¶Á≠æ');
        }
    }
}

// Êñá‰ª∂Â§πÁÇπÂáª
function handleFolderClick(data: any) {
    currentFolder.value = data.id;
    loadBookmarks();
}

// Â§ÑÁêÜÊñá‰ª∂Â§πËèúÂçïÂëΩ‰ª§
function handleFolderCommand(command: string, folderData: any) {
    switch (command) {
        case 'edit':
            editFolder(folderData);
            break;
        case 'delete':
            deleteFolderWithConfirm(folderData);
            break;
    }
}

// ÁºñËæëÊñá‰ª∂Â§π
function editFolder(folder: BookmarkTreeNode) {
    editingBookmark.value = folder;
    editForm.value = {
        id: folder.id,
        title: folder.title,
        url: '', // Êñá‰ª∂Â§πÊ≤°ÊúâURL
        parentId: folder.parentId || ''
    };
    editBookmarkDialogVisible.value = true;
}

// Âà†Èô§Êñá‰ª∂Â§πÔºàÂ∏¶Á°ÆËÆ§Ôºâ
async function deleteFolderWithConfirm(folder: BookmarkTreeNode) {
    try {
        // Ê£ÄÊü•Êñá‰ª∂Â§πÊòØÂê¶ÊúâÂ≠êÂÜÖÂÆπ
        const children = await bookmarkDB.getBookmarkChildren(folder.id);
        let confirmMessage = `Á°ÆÂÆöË¶ÅÂà†Èô§Êñá‰ª∂Â§π„Äå${folder.title}„ÄçÂêóÔºü`;
        
        if (children.length > 0) {
            confirmMessage += `\n\nÊ≥®ÊÑèÔºöËØ•Êñá‰ª∂Â§πÂåÖÂê´ ${children.length} ‰∏™Â≠êÈ°πÔºåÂà†Èô§ÂêéÂ∞ÜÊó†Ê≥ïÊÅ¢Â§çÔºÅ`;
        }
        
        const { value } = await ElMessageBox.confirm(
            confirmMessage,
            'Âà†Èô§Êñá‰ª∂Â§π',
            {
                type: 'warning',
                confirmButtonText: 'Á°ÆÂÆöÂà†Èô§',
                cancelButtonText: 'ÂèñÊ∂à',
                dangerouslyUseHTMLString: true
            }
        );
        
        if (value === 'confirm') {
            await deleteFolder(folder);
        }
    } catch (error) {
        // Áî®Êà∑ÂèñÊ∂à‰∫ÜÊìç‰Ωú
        console.log('Áî®Êà∑ÂèñÊ∂à‰∫ÜÂà†Èô§Êìç‰Ωú');
    }
}

// Âà†Èô§Êñá‰ª∂Â§π
async function deleteFolder(folder: BookmarkTreeNode) {
    try {
        ElMessage.info('Ê≠£Âú®Âà†Èô§Êñá‰ª∂Â§π...');
        
        // ‰ΩøÁî® removeTree ÊñπÊ≥ïÈÄíÂΩíÂà†Èô§Êñá‰ª∂Â§πÂèäÂÖ∂ÊâÄÊúâÂ≠êÂÜÖÂÆπ
        await bookmarkDB.removeTree(folder.id);
        
        ElMessage.success(`Êñá‰ª∂Â§π„Äå${folder.title}„ÄçÂà†Èô§ÊàêÂäü`);
        
        // Â¶ÇÊûúÂà†Èô§ÁöÑÊòØÂΩìÂâçÈÄâ‰∏≠ÁöÑÊñá‰ª∂Â§πÔºåÂàôÊ∏ÖÁ©∫ÂΩìÂâçÈÄâÊã©
        if (currentFolder.value === folder.id) {
            currentFolder.value = '';
        }
        
        // ÈáçÊñ∞Âä†ËΩΩÊï∞ÊçÆ
        await loadFolderTree();
        await loadBookmarks();
        await loadAllBookmarks();
        
        console.log('Êñá‰ª∂Â§πÂà†Èô§ÊàêÂäü:', folder);
    } catch (error) {
        ElMessage.error('Âà†Èô§Êñá‰ª∂Â§πÂ§±Ë¥•ÔºåËØ∑ÈáçËØï');
        console.error('Âà†Èô§Êñá‰ª∂Â§πÈîôËØØ:', error);
    }
}

// ÂØºÂÖ•‰π¶Á≠æ
function importBookmarks() {
    console.log('ÂØºÂÖ•‰π¶Á≠æ');
    // ÂÆûÈôÖÂ∫îÁî®‰∏≠ÔºåËøôÈáåÂ∫îËØ•ÂÆûÁé∞ÂØºÂÖ•‰π¶Á≠æÁöÑÈÄªËæë
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = '.html';
    input.onchange = (e) => {
        const file = (e.target as HTMLInputElement).files?.[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                const html = e.target?.result as string;
                const bookmarks = parseHtmlToBookmarks(html);
                console.log('ÂØºÂÖ•ÁöÑ‰π¶Á≠æ:', bookmarks);
                // ÂÆûÈôÖÂ∫îÁî®‰∏≠ÔºåËøôÈáåÂ∫îËØ•Â∞Ü‰π¶Á≠æ‰øùÂ≠òÂà∞Êï∞ÊçÆÂ∫ì
                onImportBegan();
                saveBookmarks(bookmarks).then(async () => {
                    onImportEnded();
                    // ÈáçÊñ∞Âä†ËΩΩÂÖ®ÈÉ®‰π¶Á≠æ‰ª•Êõ¥Êñ∞ÊêúÁ¥¢
                    await loadAllBookmarks();
                });
            };
            reader.readAsText(file);
        }
    };
    input.click();
}
async function saveBookmarks(bookmarks: BookmarkTreeNode[]) {
    for (const [index, bookmark] of bookmarks.entries()) {
        const node: CreateDetails = {
            title: bookmark.title,
            url: bookmark.url,
            index: index,
            type: bookmark.url ? 'bookmark' : 'folder',
            parentId: bookmark.parentId,
        };
        const result = await bookmarkDB.create(node);
        if (bookmark.children) {
            bookmark.children.forEach((b) => (b.parentId = result.id));
            await saveBookmarks(bookmark.children);
        }
    }
}

// ÂØºÂá∫‰π¶Á≠æ
async function exportBookmarks() {
    try {
        ElMessage.info('Ê≠£Âú®ÂØºÂá∫‰π¶Á≠æ...');
        
        // Ëé∑ÂèñÂÖ®ÈÉ®‰π¶Á≠æÊï∞ÊçÆ
        const allBookmarksData = await bookmarkDB.getTree();
        
        if (allBookmarksData.length === 0) {
            ElMessage.warning('Ê≤°ÊúâÂèØÂØºÂá∫ÁöÑ‰π¶Á≠æ');
            return;
        }
        
        // ÁîüÊàêÊñá‰ª∂ÂêçÔºàÂåÖÂê´Êó∂Èó¥Êà≥Ôºâ
        const timestamp = new Date().toISOString().slice(0, 19).replace(/[:.]/g, '-');
        const filename = `mynav-bookmarks-${timestamp}.html`;
        
        // Â∞Ü‰π¶Á≠æÊï∞ÊçÆËΩ¨Êç¢‰∏∫HTML
        const htmlContent = bookmarksToHtml(allBookmarksData, 'MyNav ÂØºÂá∫ÁöÑ‰π¶Á≠æ');
        
        // ÂàõÂª∫‰∏ãËΩΩÈìæÊé•
        const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        
        // ÂàõÂª∫‰∏ãËΩΩÂÖÉÁ¥†Âπ∂Ëß¶Âèë‰∏ãËΩΩ
        const downloadLink = document.createElement('a');
        downloadLink.href = url;
        downloadLink.download = filename;
        downloadLink.style.display = 'none';
        
        document.body.appendChild(downloadLink);
        downloadLink.click();
        document.body.removeChild(downloadLink);
        
        // Ê∏ÖÁêÜURLÂØπË±°
        URL.revokeObjectURL(url);
        
        ElMessage.success(`‰π¶Á≠æÂ∑≤ÊàêÂäüÂØºÂá∫‰∏∫ ${filename}`);
        
        console.log('ÂØºÂá∫‰π¶Á≠æÊàêÂäü:', {
            count: countBookmarks(allBookmarksData),
            filename,
            size: `${Math.round(blob.size / 1024)}KB`
        });
        
    } catch (error) {
        console.error('ÂØºÂá∫‰π¶Á≠æÂ§±Ë¥•:', error);
        ElMessage.error('ÂØºÂá∫‰π¶Á≠æÂ§±Ë¥•ÔºåËØ∑ÈáçËØï');
    }
}

// ËÆ°ÁÆó‰π¶Á≠æÊï∞ÈáèÔºàÈÄíÂΩíÁªüËÆ°Ôºâ
function countBookmarks(bookmarks: BookmarkTreeNode[]): number {
    let count = 0;
    for (const bookmark of bookmarks) {
        if (bookmark.type === 'bookmark') {
            count++;
        } else if (bookmark.children) {
            count += countBookmarks(bookmark.children);
        }
    }
    return count;
}

// Ê∑ªÂä†‰π¶Á≠æ
function addBookmark() {
    // ÈáçÁΩÆË°®ÂçïÊï∞ÊçÆ
    bookmarkForm.value = {
        title: '',
        url: '',
        parentId: currentFolder.value || ''
    };
    // ÊòæÁ§∫ÂØπËØùÊ°Ü
    addBookmarkDialogVisible.value = true;
}

// Á°ÆËÆ§Ê∑ªÂä†‰π¶Á≠æÊàñÊñá‰ª∂Â§π
async function confirmAddBookmark() {
    if (!bookmarkForm.value.title.trim()) {
        ElMessage.warning('ËØ∑ËæìÂÖ•Ê†áÈ¢ò');
        return;
    }
    
    const hasUrl = bookmarkForm.value.url.trim();
    
    // Â¶ÇÊûúÊúâURLÔºåÈ™åËØÅURLÊ†ºÂºè
    if (hasUrl) {
        try {
            new URL(bookmarkForm.value.url);
        } catch (error) {
            ElMessage.error('ËØ∑ËæìÂÖ•Ê≠£Á°ÆÁöÑURLÊ†ºÂºèÔºà‰ª•http://Êàñhttps://ÂºÄÂ§¥Ôºâ');
            return;
        }
    }

    try {
        const createDetails: CreateDetails = {
            title: bookmarkForm.value.title.trim(),
            url: hasUrl ? bookmarkForm.value.url.trim() : undefined,
            parentId: bookmarkForm.value.parentId || currentFolder.value,
            type: hasUrl ? 'bookmark' : 'folder',
            index: bookmarks.value.length
        };
        
        const newItem = await bookmarkDB.create(createDetails);
        
        const itemType = hasUrl ? '‰π¶Á≠æ' : 'Êñá‰ª∂Â§π';
        ElMessage.success(`${itemType}Ê∑ªÂä†ÊàêÂäü`);
        
        // ÂÖ≥Èó≠ÂØπËØùÊ°Ü
        addBookmarkDialogVisible.value = false;
        
        // ÈáçÊñ∞Âä†ËΩΩ‰π¶Á≠æÂàóË°®ÂíåÊñá‰ª∂Â§πÊ†ë
        await loadBookmarks();
        await loadFolderTree();
        
        console.log(`Êñ∞Â¢û${itemType}:`, newItem);
    } catch (error) {
        ElMessage.error('Ê∑ªÂä†Â§±Ë¥•ÔºåËØ∑ÈáçËØï');
        console.error('Ê∑ªÂä†ÈîôËØØ:', error);
    }
}

// ÂèñÊ∂àÊ∑ªÂä†‰π¶Á≠æ
function cancelAddBookmark() {
    addBookmarkDialogVisible.value = false;
    bookmarkForm.value = {
        title: '',
        url: '',
        parentId: ''
    };
}

// Ê∏ÖÁ©∫‰π¶Á≠æ
function clearBookmarks() {
    bookmarkDB.clear();
    loadBookmarks();
    loadFolderTree();
    loadAllBookmarks(); // ÈáçÊñ∞Âä†ËΩΩÂÖ®ÈÉ®‰π¶Á≠æ‰ª•Êõ¥Êñ∞ÊêúÁ¥¢
    console.log('Ê∏ÖÁ©∫‰π¶Á≠æ');

    ElMessage.success('‰π¶Á≠æÂ∑≤Ê∏ÖÁ©∫');
}

// Êñ∞Â¢ûÁöÑÂáΩÊï∞
function onChanged(id: string, changeInfo: any) {
    console.log('Bookmark changed:', id, changeInfo);
    // Â§ÑÁêÜ‰π¶Á≠æÊõ¥ÊîπÈÄªËæë
    loadBookmarks();
    loadFolderTree();
    loadAllBookmarks(); // ÈáçÊñ∞Âä†ËΩΩÂÖ®ÈÉ®‰π¶Á≠æ‰ª•Êõ¥Êñ∞ÊêúÁ¥¢
}

function onChildrenReordered(id: string, reorderInfo: object) {
    console.log('Children reordered for:', id, reorderInfo);
    // Â§ÑÁêÜÂ≠êÈ°πÈáçÊéíÈÄªËæë
    loadBookmarks();
}

function onCreated(id: string, bookmark: BookmarkTreeNode) {
    console.log('Bookmark created:', id, bookmark);
    // Â§ÑÁêÜÂàõÂª∫ÈÄªËæë
    loadBookmarks();
    loadFolderTree();
    loadAllBookmarks(); // ÈáçÊñ∞Âä†ËΩΩÂÖ®ÈÉ®‰π¶Á≠æ‰ª•Êõ¥Êñ∞ÊêúÁ¥¢
}

function onImportBegan() {
    console.log('Import began');
    // Â§ÑÁêÜÂØºÂÖ•ÂºÄÂßãÈÄªËæë
    ElMessage.info('ÂºÄÂßãÂØºÂÖ•‰π¶Á≠æ...');
}

function onImportEnded() {
    ElMessage.success(`ÊàêÂäüÂØºÂÖ•‰π¶Á≠æ`);
    loadBookmarks();
    loadFolderTree();
    loadAllBookmarks(); // ÈáçÊñ∞Âä†ËΩΩÂÖ®ÈÉ®‰π¶Á≠æ‰ª•Êõ¥Êñ∞ÊêúÁ¥¢
}

function onMoved(id: string, moveInfo: object) {
    console.log('Bookmark moved:', moveInfo);
    // Â§ÑÁêÜÁßªÂä®ÈÄªËæë
    loadBookmarks();
    loadFolderTree();
    loadAllBookmarks(); // ÈáçÊñ∞Âä†ËΩΩÂÖ®ÈÉ®‰π¶Á≠æ‰ª•Êõ¥Êñ∞ÊêúÁ¥¢
}

async function onRemoved(id: string, removeInfo: object) {
    await bookmarkDB.remove(id);
    console.log('Bookmark removed:', removeInfo);
    // Â§ÑÁêÜÂà†Èô§ÈÄªËæë
    loadBookmarks();
    loadFolderTree();
    loadAllBookmarks(); // ÈáçÊñ∞Âä†ËΩΩÂÖ®ÈÉ®‰π¶Á≠æ‰ª•Êõ¥Êñ∞ÊêúÁ¥¢
}

// ÁºñËæë‰π¶Á≠æ
function editBookmark(bookmark: BookmarkTreeNode) {
    editingBookmark.value = bookmark;
    editForm.value = {
        id: bookmark.id,
        title: bookmark.title,
        url: bookmark.url || '',
        parentId: bookmark.parentId || ''
    };
    editBookmarkDialogVisible.value = true;
}

// Á°ÆËÆ§ÁºñËæë
async function confirmEdit() {
    if (!editForm.value.title.trim()) {
        ElMessage.warning('ËØ∑ËæìÂÖ•Ê†áÈ¢ò');
        return;
    }
    
    const hasUrl = editForm.value.url.trim();
    
    // Â¶ÇÊûúÊúâURLÔºåÈ™åËØÅURLÊ†ºÂºè
    if (hasUrl) {
        try {
            new URL(editForm.value.url);
        } catch (error) {
            ElMessage.error('ËØ∑ËæìÂÖ•Ê≠£Á°ÆÁöÑURLÊ†ºÂºèÔºà‰ª•http://Êàñhttps://ÂºÄÂ§¥Ôºâ');
            return;
        }
    }

    try {
        const changes: any = {
            title: editForm.value.title.trim(),
            parentId: editForm.value.parentId || null
        };
        
        // Âè™Êúâ‰π¶Á≠æÊâçÊõ¥Êñ∞URL
        if (editingBookmark.value?.url !== undefined) {
            changes.url = hasUrl ? editForm.value.url.trim() : undefined;
            if (changes.url) {
                changes.icon = bookmarkDB.getGoogleFaviconUrl(changes.url);
            }
        }
        
        await bookmarkDB.update(editForm.value.id, changes);
        
        const itemType = editingBookmark.value?.url ? '‰π¶Á≠æ' : 'Êñá‰ª∂Â§π';
        ElMessage.success(`${itemType}ÁºñËæëÊàêÂäü`);
        
        // ÂÖ≥Èó≠ÂØπËØùÊ°Ü
        editBookmarkDialogVisible.value = false;
        
        // ÈáçÊñ∞Âä†ËΩΩ‰π¶Á≠æÂàóË°®ÂíåÊñá‰ª∂Â§πÊ†ë
        await loadBookmarks();
        await loadFolderTree();
        // ÈáçÊñ∞Âä†ËΩΩÂÖ®ÈÉ®‰π¶Á≠æ‰ª•Êõ¥Êñ∞ÊêúÁ¥¢
        await loadAllBookmarks();
        
        console.log(`ÁºñËæë${itemType}:`, changes);
    } catch (error) {
        ElMessage.error('ÁºñËæëÂ§±Ë¥•ÔºåËØ∑ÈáçËØï');
        console.error('ÁºñËæëÈîôËØØ:', error);
    }
}

// ÂèñÊ∂àÁºñËæë
function cancelEdit() {
    editBookmarkDialogVisible.value = false;
    editForm.value = {
        id: '',
        title: '',
        url: '',
        parentId: ''
    };
    editingBookmark.value = null;
}
</script>

<style scoped>
/* Â∫îÁî®ÂÆπÂô® */
.app-container {
    min-height: 100vh;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}

.main-container {
    min-height: 100vh;
    backdrop-filter: blur(10px);
}

/* Â§¥ÈÉ®Ê†∑Âºè */
.header-section {
    padding: 20px 32px;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    min-height: 100px;
    display: flex;
    align-items: center;
}

.header-content {
    max-width: 1200px;
    margin: 0 auto;
    width: 100%;
}

.search-wrapper {
    position: relative;
}

.search-input {
    width: 100%;
}

.filter-btn {
    margin-right: 16px;
    background: rgba(255, 255, 255, 0.9);
    border: none;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
    width: 40px;
    height: 40px;
    border-radius: 50%;
}

.filter-btn:hover {
    background: white;
    transform: translateY(-2px) scale(1.1);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

/* ÂÜÖÂÆπÂÆπÂô® */
.content-container {
    background: rgba(255, 255, 255, 0.95);
    margin: 0 16px 16px 16px;
    border-radius: 24px;
    overflow: hidden;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    backdrop-filter: blur(10px);
}

/* ‰æßËæπÊ†èÊ†∑Âºè */
.sidebar {
    width: 280px;
    background: linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%);
    border-right: 1px solid #e2e8f0;
    padding: 0;
}

.sidebar-header {
    padding: 24px 20px 16px 20px;
    border-bottom: 1px solid #e2e8f0;
    background: white;
}

.sidebar-title {
    display: flex;
    align-items: center;
    margin: 0;
    font-size: 16px;
    font-weight: 600;
    color: #374151;
    gap: 8px;
}

.sidebar-icon {
    color: #6366f1;
}

.folder-tree-wrapper {
    padding: 16px;
}

.folder-tree {
    background: transparent;
}

/* Êñá‰ª∂Â§πÊ†ëËäÇÁÇπÊ†∑Âºè */
.folder-tree-node {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    width: 100%;
    min-height: 32px;
    border-radius: 8px;
    transition: all 0.2s ease;
    cursor: pointer;
    user-select: none;
}

.folder-tree-node:hover {
    background: rgba(99, 102, 241, 0.1);
    transform: translateX(2px);
}

.folder-icon {
    font-size: 16px;
    color: #6366f1;
    flex-shrink: 0;
}

.folder-name {
    font-size: 14px;
    color: #374151;
    font-weight: 500;
    flex: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* Á°Æ‰øùdropdownËß¶ÂèëÂå∫ÂüüË¶ÜÁõñÊï¥‰∏™ËäÇÁÇπ */
:deep(.el-tree-node__content) {
    padding: 0 !important;
}

:deep(.el-tree-node__content .el-dropdown) {
    width: 100%;
}

:deep(.el-tree-node__content .el-dropdown > div) {
    width: 100%;
}

/* ‰∏ªÂÜÖÂÆπÂå∫Ê†∑Âºè */
.main-content {
    background: white;
    padding: 24px;
}

/* Â∑•ÂÖ∑Ê†èÊ†∑Âºè */
.toolbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 24px;
    padding: 20px;
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
    border-radius: 16px;
    border: 1px solid #e2e8f0;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
}

.toolbar-section {
    display: flex;
    gap: 12px;
    align-items: center;
}

.action-btn {
    border-radius: 12px;
    padding: 12px 20px;
    font-weight: 500;
    transition: all 0.3s ease;
    border: none;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.action-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
}

.import-btn {
    background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
}

.export-btn {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
}

.add-btn {
    background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
}

.clear-btn {
    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
}

/* ÁªüËÆ°Ê†è */
.stats-bar {
    display: flex;
    gap: 24px;
    margin-bottom: 20px;
    padding: 16px 20px;
    background: linear-gradient(135deg, #fef3c7 0%, #fbbf24 100%);
    border-radius: 12px;
    border: 1px solid #f59e0b;
}

.stats-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    font-weight: 500;
    color: #92400e;
}

/* ‰π¶Á≠æÂÆπÂô® */
.bookmarks-container {
    min-height: 400px;
    max-width: 1200px;
    margin: 0 auto;
    width: 100%;
}

.bookmarks-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 16px;
    padding: 4px;
    width: 100%;
    box-sizing: border-box;
}

.bookmark-card-wrapper {
    transition: all 0.3s ease;
    width: 100%;
    min-width: 0;
}

.bookmark-card {
    height: auto;
    min-height: 120px;
    border-radius: 16px;
    border: 1px solid #e2e8f0;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    background: white;
    overflow: hidden;
    cursor: pointer;
    position: relative;
    width: 100%;
    box-sizing: border-box;
}

.bookmark-card:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
    border-color: #6366f1;
}

/* ‰π¶Á≠æ‰∏ª‰ΩìÂÜÖÂÆπÂå∫Âüü */
.bookmark-body {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 16px;
    position: relative;
    transition: transform 0.3s ease;
}

.bookmark-card:hover .bookmark-body {
    transform: translateY(-2px);
}

/* Â∑¶‰æßÂõæÊ†áÂå∫Âüü */
.bookmark-favicon {
    flex-shrink: 0;
    display: flex;
    align-items: center;
}

.favicon {
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
}

.bookmark-card:hover .favicon {
    transform: scale(1.05);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
}

/* Âè≥‰æß‰ø°ÊÅØÂå∫Âüü */
.bookmark-info {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    gap: 6px;
    overflow: hidden;
}

.bookmark-title {
    width: 100%;
    min-width: 0;
}

.title-text {
    font-weight: 600;
    color: #1f2937;
    font-size: 14px;
    line-height: 1.3;
    display: block;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    width: 100%;
}

.bookmark-url-container {
    width: 100%;
    min-width: 0;
}

.bookmark-url {
    display: block;
    padding: 8px 10px;
    background: #f8fafc;
    border-radius: 8px;
    border: 1px solid #e2e8f0;
    transition: all 0.3s ease;
    width: 100%;
    min-height: 46px;
    cursor: inherit;
    box-sizing: border-box;
    overflow: hidden;
}

.bookmark-card:hover .bookmark-url {
    background: #f1f5f9;
    border-color: #6366f1;
}

.url-text {
    font-size: 12px;
    color: #6b7280;
    line-height: 1.3;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    word-break: break-all;
    width: 100%;
    box-sizing: border-box;
}

/* Êìç‰ΩúÊåâÈíÆÊ†∑Âºè */
.bookmark-actions {
    display: flex;
    flex-direction: column;
    gap: 6px;
    align-items: center;
    visibility: hidden;
    opacity: 0;
    z-index: 50;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    transform: scale(0.9);
    flex-shrink: 0;
    padding: 6px;
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%) scale(0.9);
}

/* Âç°ÁâáÊÇ¨ÂÅúÊó∂ÊòæÁ§∫ÊåâÈíÆ */
.bookmark-card:hover .bookmark-actions {
    visibility: visible;
    opacity: 1;
    transform: translateY(-50%) scale(1);
}

.action-btn-circle {
    width: 26px;
    height: 26px;
    border-radius: 50%;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    border: none;
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 11px;
    cursor: pointer;
    position: relative;
    z-index: 100;
    opacity: 0.9;
    visibility: visible;
    pointer-events: auto;
    transform: scale(1);
}

/* Âç°ÁâáÊÇ¨ÂÅúÊó∂ÊåâÈíÆÊîæÂ§ßÂπ∂ÂÆåÂÖ®ÊòæÁ§∫ */
.bookmark-card:hover .action-btn-circle {
    opacity: 1;
    transform: scale(1.05);
}

.action-btn-circle:hover {
    transform: translateY(-2px) scale(1.15) !important;
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2) !important;
}

.action-btn-circle:active {
    transform: translateY(-1px) scale(1.1) !important;
}

.edit-action {
    background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%) !important;
    color: white !important;
}

.edit-action:hover {
    background: linear-gradient(135deg, #1d4ed8 0%, #1e40af 100%) !important;
}

.delete-action {
    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%) !important;
    color: white !important;
}

.delete-action:hover {
    background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%) !important;
}

/* Á©∫Áä∂ÊÄÅ */
.empty-state {
    text-align: center;
    padding: 80px 20px;
    color: #6b7280;
}

.empty-icon {
    margin-bottom: 24px;
    opacity: 0.6;
}

.empty-title {
    font-size: 24px;
    font-weight: 600;
    margin-bottom: 12px;
    color: #374151;
}

.empty-description {
    font-size: 16px;
    margin-bottom: 32px;
    color: #6b7280;
    line-height: 1.6;
}

.empty-action {
    border-radius: 12px;
    padding: 12px 32px;
    font-size: 16px;
    font-weight: 500;
    background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
    border: none;
    box-shadow: 0 4px 16px rgba(99, 102, 241, 0.3);
    transition: all 0.3s ease;
}

.empty-action:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4);
}

/* ÂìçÂ∫îÂºèËÆæËÆ° */
@media (max-width: 768px) {
    .header-section {
        padding: 16px 20px;
        min-height: 80px;
    }
    
    .header-content {
        max-width: 100%;
    }
    
    :deep(.el-input__wrapper) {
        height: 52px;
    }
    
    :deep(.el-input__inner) {
        font-size: 16px;
        height: 48px;
        line-height: 48px;
        padding: 0 20px;
    }
    
    :deep(.el-input__inner::placeholder) {
        font-size: 14px;
    }
    
    :deep(.el-input__prefix) {
        font-size: 18px;
        height: 48px;
    }
    
    :deep(.el-input__suffix) {
        height: 48px;
    }
    
    .filter-btn {
        width: 36px;
        height: 36px;
    }
    
    .content-container {
        margin: 0 8px 8px 8px;
        border-radius: 16px;
    }
    
    .sidebar {
        width: 100%;
        max-width: 100%;
    }
    
    .main-content {
        padding: 16px;
    }
    
    .toolbar {
        flex-direction: column;
        gap: 16px;
        padding: 16px;
    }
    
    .toolbar-section {
        width: 100%;
        justify-content: center;
        flex-wrap: wrap;
    }
    
    .bookmarks-container {
        max-width: 100%;
        padding: 0 8px;
    }
    
    .bookmarks-grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 12px;
        padding: 2px;
    }
    
    .bookmark-card {
        min-height: 110px;
    }
    
    .bookmark-body {
        padding: 14px;
        gap: 10px;
    }
    
    .favicon {
        width: 36px !important;
        height: 36px !important;
    }
    
    .title-text {
        font-size: 13px;
    }
    
    .url-text {
        font-size: 11px;
    }
    
    .action-btn-circle {
        width: 24px;
        height: 24px;
        font-size: 10px;
    }
    
    .bookmark-actions {
        gap: 4px;
        padding: 4px;
        right: 8px;
    }
}

@media (max-width: 480px) {
    .header-section {
        padding: 12px 16px;
        min-height: 70px;
    }
    
    .header-content {
        max-width: 100%;
    }
    
    :deep(.el-input__wrapper) {
        height: 48px;
        border-radius: 20px;
    }
    
    :deep(.el-input__inner) {
        font-size: 15px;
        height: 44px;
        line-height: 44px;
        padding: 0 18px;
    }
    
    :deep(.el-input__inner::placeholder) {
        font-size: 13px;
    }
    
    :deep(.el-input__prefix) {
        font-size: 16px;
        height: 44px;
        margin-left: 6px;
    }
    
    :deep(.el-input__suffix) {
        height: 44px;
        margin-right: 6px;
    }
    
    .filter-btn {
        width: 32px;
        height: 32px;
        margin-right: 12px;
    }
    
    .content-container {
        margin: 0 4px 4px 4px;
        border-radius: 12px;
    }
    
    .toolbar {
        padding: 12px;
    }
    
    .action-btn {
        padding: 10px 16px;
        font-size: 14px;
    }
    
    .bookmarks-container {
        max-width: 100%;
        padding: 0 4px;
    }
    
    .bookmarks-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        padding: 2px;
    }
    
    .bookmark-card {
        min-height: 100px;
    }
    
    .bookmark-body {
        padding: 10px;
        gap: 8px;
    }
    
    .favicon {
        width: 32px !important;
        height: 32px !important;
    }
    
    .title-text {
        font-size: 12px;
    }
    
    .url-text {
        font-size: 10px;
        -webkit-line-clamp: 2;
    }
    
    .bookmark-url {
        padding: 6px 8px;
        min-height: 40px;
    }
    
    .action-btn-circle {
        width: 22px;
        height: 22px;
        font-size: 9px;
    }
    
    .bookmark-actions {
        gap: 3px;
        padding: 3px;
        right: 6px;
        border-radius: 10px;
    }
    
    .action-btn-circle {
        width: 24px;
        height: 24px;
        font-size: 10px;
    }
    
    .bookmark-actions {
        gap: 3px;
        padding: 3px 5px;
        top: 4px;
        right: 4px;
        border-radius: 12px;
    }
}

/* ÊîπËøõÊêúÁ¥¢Ê°ÜËæìÂÖ•Ê†∑Âºè */
:deep(.el-input__wrapper) {
    border-radius: 25px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
    border: 2px solid rgba(255, 255, 255, 0.3);
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    transition: all 0.3s ease;
    height: 60px;
    padding: 0 8px;
}

:deep(.el-input__wrapper:hover) {
    border-color: rgba(255, 255, 255, 0.5);
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
    transform: translateY(-2px);
}

:deep(.el-input__wrapper.is-focus) {
    border-color: #6366f1;
    box-shadow: 0 12px 40px rgba(99, 102, 241, 0.25);
    background: white;
    transform: translateY(-2px);
}

:deep(.el-input__inner) {
    font-size: 18px;
    color: #1f2937;
    font-weight: 500;
    padding: 0 24px;
    height: 56px;
    line-height: 56px;
}

:deep(.el-input__inner::placeholder) {
    color: #6b7280;
    font-weight: 400;
    font-size: 16px;
}

:deep(.el-input__prefix) {
    color: #6b7280;
    font-size: 20px;
    margin-left: 8px;
    height: 56px;
    display: flex;
    align-items: center;
}

:deep(.el-input__suffix) {
    height: 56px;
    display: flex;
    align-items: center;
    margin-right: 8px;
}

/* Ê†ëÂΩ¢ÁªÑ‰ª∂Ê†∑Âºè */
:deep(.el-tree-node__content) {
    height: 44px;
    padding: 0 16px;
    border-radius: 8px;
    margin: 2px 0;
    transition: all 0.3s ease;
}

:deep(.el-tree-node__content:hover) {
    background: #f3f4f6;
    transform: translateX(4px);
}

:deep(.el-tree-node.is-current > .el-tree-node__content) {
    background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
    color: white;
    font-weight: 500;
}

:deep(.el-tree-node__expand-icon) {
    color: #6b7280;
    font-size: 14px;
}

:deep(.is-current .el-tree-node__expand-icon) {
    color: white;
}

/* ‰∏ãÊãâËèúÂçïÊ†∑Âºè */
.filter-dropdown {
    border-radius: 12px;
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
    border: 1px solid #e2e8f0;
    padding: 8px;
}

:deep(.el-dropdown-menu__item) {
    border-radius: 8px;
    margin: 2px 0;
    padding: 10px 16px;
    transition: all 0.3s ease;
    font-weight: 500;
}

:deep(.el-dropdown-menu__item:hover) {
    background: #f3f4f6;
    color: #6366f1;
    transform: translateX(4px);
}

/* Âç°ÁâáÂ§¥ÈÉ®Ê†∑Âºè‰ºòÂåñ */
:deep(.el-card__header) {
    padding: 16px 20px;
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
    border-bottom: 1px solid #e2e8f0;
    flex-shrink: 0;
    min-height: 80px;
    display: flex;
    align-items: center;
}

:deep(.el-card__body) {
    padding: 16px 20px;
    height: 100px;
    display: flex;
    flex-direction: column;
    flex-shrink: 0;
}
</style>

<style>
/* ÂÖ®Â±ÄÊ†∑ÂºèÔºà‰∏çÂèó scoped ÈôêÂà∂Ôºâ*/
.search-suggestions {
    border-radius: 16px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
    border: 1px solid #e2e8f0;
    margin-top: 8px;
    backdrop-filter: blur(20px);
    background: rgba(255, 255, 255, 0.95);
}

.search-suggestions .el-autocomplete-suggestion__list {
    padding: 12px;
}

.search-suggestions .el-autocomplete-suggestion__list li {
    border-radius: 12px;
    margin: 4px 0;
    padding: 12px 16px;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    border: 1px solid transparent;
}

.search-suggestions .el-autocomplete-suggestion__list li:hover {
    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
    transform: translateX(8px) scale(1.02);
    border-color: #0ea5e9;
    box-shadow: 0 8px 20px rgba(14, 165, 233, 0.15);
}

.search-suggestions .el-autocomplete-suggestion__list li.highlighted {
    background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
    border-color: #3b82f6;
    transform: translateX(8px) scale(1.02);
    box-shadow: 0 8px 20px rgba(59, 130, 246, 0.2);
}

/* Âª∫ËÆÆÈ°π‰∏≠ÁöÑÂõæÊ†áÂíåÊñáÊú¨Ê†∑Âºè */
.search-suggestions .el-avatar {
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.search-suggestions .el-icon {
    color: #6b7280;
    transition: color 0.3s ease;
}

.search-suggestions .el-autocomplete-suggestion__list li:hover .el-icon {
    color: #0ea5e9;
}

.search-suggestions .el-autocomplete-suggestion__list li.highlighted .el-icon {
    color: #3b82f6;
}

/* ÊêúÁ¥¢Âª∫ËÆÆÈ°πÂÜÖÂÆπÊ†∑Âºè */
.search-suggestions .el-autocomplete-suggestion__list li > div {
    border-radius: 8px;
}

.search-suggestions .el-autocomplete-suggestion__list li > div > div:first-child {
    font-weight: 600;
    color: #1f2937;
    margin-bottom: 4px;
    font-size: 15px;
}

.search-suggestions .el-autocomplete-suggestion__list li > div > div:not(:first-child) {
    font-size: 13px;
    color: #6b7280;
    line-height: 1.4;
}

.search-suggestions .el-autocomplete-suggestion__list li:hover > div > div:first-child {
    color: #0ea5e9;
}

.search-suggestions .el-autocomplete-suggestion__list li.highlighted > div > div:first-child {
    color: #3b82f6;
}

/* ÂØπËØùÊ°ÜÊ†∑Âºè‰ºòÂåñ */
.el-dialog {
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 25px 80px rgba(0, 0, 0, 0.15);
    backdrop-filter: blur(20px);
}

.el-dialog__header {
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
    padding: 24px 32px;
    border-bottom: 1px solid #e2e8f0;
}

.el-dialog__title {
    font-weight: 600;
    font-size: 18px;
    color: #1f2937;
}

.el-dialog__body {
    padding: 32px;
}

.el-dialog__footer {
    padding: 24px 32px;
    background: #f8fafc;
    border-top: 1px solid #e2e8f0;
}

/* Ë°®ÂçïÊ†∑Âºè‰ºòÂåñ */
.el-form-item__label {
    font-weight: 600;
    color: #374151;
    font-size: 14px;
}

.el-input {
    border-radius: 12px;
}

.el-input__wrapper {
    border-radius: 12px;
    transition: all 0.3s ease;
}

.el-input__wrapper:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.el-input__wrapper.is-focus {
    box-shadow: 0 4px 16px rgba(99, 102, 241, 0.2);
}

/* ÊåâÈíÆÊ†∑Âºè‰ºòÂåñ */
.el-button {
    border-radius: 12px;
    font-weight: 500;
    transition: all 0.3s ease;
}

.el-button:hover {
    transform: translateY(-1px);
}

.el-button--primary {
    background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
    border: none;
    box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
}

.el-button--primary:hover {
    box-shadow: 0 8px 20px rgba(99, 102, 241, 0.4);
}

.el-button--success {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    border: none;
    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
}

.el-button--success:hover {
    box-shadow: 0 8px 20px rgba(16, 185, 129, 0.4);
}

.el-button--danger {
    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    border: none;
    box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
}

.el-button--danger:hover {
    box-shadow: 0 8px 20px rgba(239, 68, 68, 0.4);
}

/* Ê†ëÈÄâÊã©Âô®Ê†∑Âºè */
.el-tree-select {
    border-radius: 12px;
}

.el-tree-select__wrapper {
    border-radius: 12px;
}

/* Âº∫Âà∂Ë¶ÜÁõñElement PlusÊåâÈíÆÊ†∑Âºè */
:deep(.bookmark-actions .el-button) {
    width: 28px !important;
    height: 28px !important;
    border-radius: 50% !important;
    border: none !important;
    padding: 0 !important;
    margin: 0 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 12px !important;
    cursor: pointer !important;
    position: relative !important;
    z-index: 100 !important;
    opacity: 0.9 !important;
    visibility: visible !important;
    pointer-events: auto !important;
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1) !important;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
    transform: scale(1) !important;
}

:deep(.bookmark-card:hover .bookmark-actions .el-button) {
    opacity: 1 !important;
    transform: scale(1.05) !important;
}

:deep(.bookmark-actions .el-button:hover) {
    transform: translateY(-2px) scale(1.2) !important;
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2) !important;
}

:deep(.bookmark-actions .el-button.edit-action) {
    background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%) !important;
    color: white !important;
}

:deep(.bookmark-actions .el-button.delete-action) {
    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%) !important;
    color: white !important;
}

:deep(.bookmark-actions .el-button .el-icon) {
    color: white !important;
    font-size: 12px !important;
}
.el-message {
    border-radius: 12px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
    backdrop-filter: blur(10px);
}

/* Âä†ËΩΩÂä®Áîª */
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.bookmark-card-wrapper {
    animation: fadeInUp 0.6s ease forwards;
}

.bookmark-card-wrapper:nth-child(1) { animation-delay: 0.1s; }
.bookmark-card-wrapper:nth-child(2) { animation-delay: 0.2s; }
.bookmark-card-wrapper:nth-child(3) { animation-delay: 0.3s; }
.bookmark-card-wrapper:nth-child(4) { animation-delay: 0.4s; }
.bookmark-card-wrapper:nth-child(5) { animation-delay: 0.5s; }
.bookmark-card-wrapper:nth-child(6) { animation-delay: 0.6s; }

/* Element Plus Dropdown ËèúÂçïÊ†∑Âºè‰ºòÂåñ */
:deep(.el-dropdown-menu) {
    border-radius: 12px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
    border: 1px solid rgba(0, 0, 0, 0.1);
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    padding: 8px 0;
    min-width: 160px;
}

:deep(.el-dropdown-menu__item) {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    color: #374151;
    font-size: 14px;
    font-weight: 500;
    gap: 8px;
    border-radius: 8px;
    margin: 2px 8px;
    transition: all 0.2s ease;
}

:deep(.el-dropdown-menu__item:hover) {
    background: rgba(99, 102, 241, 0.1);
    color: #6366f1;
}

:deep(.el-dropdown-menu__item:focus) {
    background: rgba(99, 102, 241, 0.1);
    color: #6366f1;
}

:deep(.el-dropdown-menu__item.is-divided) {
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin-top: 8px;
}

/* Âà†Èô§ÊåâÈíÆÁâπÊÆäÊ†∑Âºè */
:deep(.el-dropdown-menu__item[data-command="delete"]) {
    color: #ef4444;
}

:deep(.el-dropdown-menu__item[data-command="delete"]:hover) {
    background: rgba(239, 68, 68, 0.1);
    color: #dc2626;
}
</style>
